{"ast":null,"code":"import _slicedToArray from\"/home/matt/Documents/new-personal-projects/e-commerce/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useRef,useEffect}from'react';import{useGlobalContext}from'../context/Context';import axios from\"axios\";import{useNavigate,useParams}from\"react-router-dom\";import{getByPlaceholderText}from'@testing-library/react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Products=function Products(){var productId=useParams();var _useGlobalContext=useGlobalContext(),filtered=_useGlobalContext.filtered,redirect=_useGlobalContext.redirect,setRedirect=_useGlobalContext.setRedirect,cart=_useGlobalContext.cart,setCart=_useGlobalContext.setCart,getCart=_useGlobalContext.getCart;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),singleProductId=_useState2[0],setSingleProductId=_useState2[1];var navigate=useNavigate();// get products for product details page\nuseEffect(function(){var isMounted=true;axios.get(\"http://localhost:8001/products/\".concat(productId.productId)).then(function(res){console.log(res.data.id);if(isMounted){setSingleProductId([res.data.id]);console.log(singleProductId);isMounted=false;return res;}}).catch(function(err){console.log(err);});},[productId.id]);// send post request to add item to cart, set redirect state to true.\nvar handleSubmit=function handleSubmit(e){e.preventDefault();var request={method:'POST',url:\"http://localhost:8001/cart\",headers:{'Content-Type':'application/json'},data:{productId:singleProductId[0]}};axios(request).then(function(){return setRedirect(true);}).catch(function(err){return console.log(err);});};// redirects to Cart page based on whether redirect state is sett to true/false. redirect is then reset to false.\nuseEffect(function(){if(redirect){navigate('/cart');setRedirect(false);}else{console.log('red off');}},[cart]);var productDetails=filtered.filter(function(product){return singleProductId==product.id;});return/*#__PURE__*/_jsx(_Fragment,{children:productDetails.map(function(product){var id=product.id,title=product.title,description=product.description,medImageUrl=product.medImageUrl,imageUrl=product.imageUrl,price=product.price,category=product.category;return/*#__PURE__*/_jsxs(\"div\",{className:\"product-details-main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"product-details\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\".concat(title.substring(0,100)).toUpperCase()}),/*#__PURE__*/_jsx(\"div\",{className:\"product-details-image\",children:/*#__PURE__*/_jsx(\"img\",{src:medImageUrl,alt:\"description\"})}),\"  \"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-details-right-sidebar\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Price: $\",price]}),/*#__PURE__*/_jsx(\"p\",{children:description}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,children:\"Add to cart\"})]})]});})});};export default Products;","map":{"version":3,"sources":["/home/matt/Documents/new-personal-projects/e-commerce/src/components/ProductDetails.js"],"names":["React","useState","useRef","useEffect","useGlobalContext","axios","useNavigate","useParams","getByPlaceholderText","Products","productId","filtered","redirect","setRedirect","cart","setCart","getCart","singleProductId","setSingleProductId","navigate","isMounted","get","then","res","console","log","data","id","catch","err","handleSubmit","e","preventDefault","request","method","url","headers","productDetails","filter","product","map","title","description","medImageUrl","imageUrl","price","category","substring","toUpperCase"],"mappings":"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","sourcesContent":["\nimport React, {useState, useRef, useEffect} from 'react';\nimport { useGlobalContext } from '../context/Context';\nimport axios from \"axios\";    \nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { getByPlaceholderText } from '@testing-library/react';\n\nconst Products = () => {\nconst productId = useParams();\nconst { filtered, redirect, setRedirect, cart, setCart, getCart} = useGlobalContext()\n    const [singleProductId, setSingleProductId] = useState([])\n\n  const navigate = useNavigate();\n\n    // get products for product details page\n        useEffect(()=> {\n             let isMounted = true; \n            axios.get(`http://localhost:8001/products/${productId.productId}`)\n            .then(res => {\n              console.log(res.data.id)\n              if (isMounted) {\n           setSingleProductId([res.data.id])  \n           console.log(singleProductId)\n         isMounted = false\n                return res }\n            })\n            .catch(err =>{\n                console.log(err)\n            })\n        }, [productId.id])\n\n     \n\n// send post request to add item to cart, set redirect state to true.\n    const handleSubmit =  e => {\n    e.preventDefault();\n\n    let request = {method: 'POST',\n            url: \"http://localhost:8001/cart\",\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            data: {\n               productId: singleProductId[0]}}\n            axios(request)\n                .then(() => {\n                 \n                  return   setRedirect(true)\n    })   \n        .catch(err => console.log(err))\n }\n  \n\n        // redirects to Cart page based on whether redirect state is sett to true/false. redirect is then reset to false.\n       useEffect(() => {\n         if (redirect) {\n              navigate('/cart')\n               setRedirect(false)\n         }\n          \n          else {\n          console.log('red off')\n        }  }, [cart])\n\nconst productDetails = filtered.filter((product) => {\n\n       return singleProductId == product.id\n    })\n  return (\n<>\n {productDetails.map(product => {\n    const {id, title, description, medImageUrl, imageUrl, price, category} = product;\n    return (\n<div className='product-details-main'>\n\n          <div className='product-details'>\n         <h2>{`${title.substring(0, 100)}`.toUpperCase()}</h2>\n                      <div className='product-details-image'>\n\n            <img src={medImageUrl} alt=\"description\" />\n        </div>  </div>\n   \n\n <div className=\"product-details-right-sidebar\">\n<h2>Price: ${price}</h2>\n\n<p>{description}\n</p>\n\n<button onClick={handleSubmit}>Add to cart</button>\n\n\n</div>\n</div>\n  ) })}      \n   \n\n    \n</>\n  );\n};\n\nexport default Products;\n\n\n\n"]},"metadata":{},"sourceType":"module"}